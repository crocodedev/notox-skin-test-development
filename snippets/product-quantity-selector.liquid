{%- assign show_button_buy = block.settings.show_button_buy | default: false -%}
{%- capture variables -%}
    {%- if block.settings.margin_top_desktop != 0 -%}
        --margin_top_desktop: {{- block.settings.margin_top_desktop | append: 'px;' -}}
    {%- endif -%}
    {%- if block.settings.margin_bottom_desktop != 0 -%}
        --margin_bottom_desktop: {{- block.settings.margin_bottom_desktop | append: 'px;' -}}
    {%- endif -%}
    {%- if block.settings.margin_top_mobile != 0 -%}
        --margin_top_mobile: {{- block.settings.margin_top_mobile | append: 'px;' -}}
    {%- endif -%}
    {%- if block.settings.margin_bottom_mobile != 0 -%}
        --margin_bottom_mobile: {{- block.settings.margin_bottom_mobile | append: 'px;' -}}
    {%- endif -%}
{%- endcapture -%}

<product-form class="product__quantity-selector" style="{{- variables -}}">
    {%- form 'product',
            product,
            id: product_form_id,
            class: 'form contents',
            novalidate: 'novalidate',
            data-type: 'add-to-cart-form'
    -%}
        {%- if isVariantPicker == 0 -%}
            <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
        {%- endif -%}
        <div class="product__quantity-selector-input-container js-quantity-container">
            <button class="product__quantity-selector-input-button js-quantity-button" value="+">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                    <path d="M0-7.5a9.924,9.924,0,0,1,1.367-5.039,9.907,9.907,0,0,1,3.594-3.594A9.924,9.924,0,0,1,10-17.5a9.924,9.924,0,0,1,5.039,1.367,9.907,9.907,0,0,1,3.594,3.594A9.924,9.924,0,0,1,20-7.5a9.924,9.924,0,0,1-1.367,5.039,9.907,9.907,0,0,1-3.594,3.594A9.924,9.924,0,0,1,10,2.5,9.924,9.924,0,0,1,4.961,1.133,9.907,9.907,0,0,1,1.367-2.461,9.924,9.924,0,0,1,0-7.5ZM10-3.125a.934.934,0,0,0,.938-.937v-2.5h2.5a.934.934,0,0,0,.938-.937.934.934,0,0,0-.937-.937h-2.5v-2.5A.934.934,0,0,0,10-11.875a.934.934,0,0,0-.937.938v2.5h-2.5a.934.934,0,0,0-.937.938.934.934,0,0,0,.938.938h2.5v2.5A.934.934,0,0,0,10-3.125Z"
                          transform="translate(0 17.5)" fill="currentColor"/>
                </svg>
            </button>
            <input
                    type="number"
                    class="product__quantity-selector-input js-quantity-input"
                    name="quantity"
                    data-min="{{ product.selected_or_first_available_variant.quantity_rule.min }}"
                    min="{{ product.selected_or_first_available_variant.quantity_rule.min }}"
                    {% if product.selected_or_first_available_variant.quantity_rule.max != null %}
                        data-max="{{ product.selected_or_first_available_variant.quantity_rule.max }}"
                        max="{{ product.selected_or_first_available_variant.quantity_rule.max }}"
                    {% endif %}
                    value="{{ product.selected_or_first_available_variant.quantity_rule.min }}"
                    step="{{ product.selected_or_first_available_variant.quantity_rule.increment }}"
                    form="{{- product_form_id -}}"
            >
            <button class="product__quantity-selector-input-button js-quantity-button" value="-">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                    <path d="M0-7.5a9.924,9.924,0,0,1,1.367-5.039,9.907,9.907,0,0,1,3.594-3.594A9.924,9.924,0,0,1,10-17.5a9.924,9.924,0,0,1,5.039,1.367,9.907,9.907,0,0,1,3.594,3.594A9.924,9.924,0,0,1,20-7.5a9.924,9.924,0,0,1-1.367,5.039,9.907,9.907,0,0,1-3.594,3.594A9.924,9.924,0,0,1,10,2.5,9.924,9.924,0,0,1,4.961,1.133,9.907,9.907,0,0,1,1.367-2.461,9.924,9.924,0,0,1,0-7.5Zm6.563-.937a.934.934,0,0,0-.937.938.934.934,0,0,0,.938.938h6.875a.934.934,0,0,0,.938-.937.934.934,0,0,0-.937-.937Z"
                          transform="translate(0 17.5)" fill="currentColor"/>
                </svg>
            </button>
        </div>

        {%- if show_button_buy == true -%}
            {%- liquid
                assign check_against_inventory = true
                if product.selected_or_first_available_variant.inventory_management != 'shopify' or product.selected_or_first_available_variant.inventory_policy == 'continue'
                    assign check_against_inventory = false
                endif
                if product.selected_or_first_available_variant.quantity_rule.min > product.selected_or_first_available_variant.inventory_quantity and check_against_inventory
                    assign quantity_rule_soldout = true
                endif
            -%}
            <button
                    class="product__quantity-selector-btn js-button-buy"
                    {% if product.selected_or_first_available_variant.available == false or quantity_rule_soldout %}
                        disabled
                    {% endif %}
            >
                <span class="product__quantity-selector-btn-text js-button-buy-text" data-add="{{ 'products.product.add_to_cart' | t }}" data-sold="{{ 'products.product.sold_out' | t }}">
                    {%- if product.selected_or_first_available_variant.available == false or quantity_rule_soldout -%}
                        {{ 'products.product.sold_out' | t }}
                    {%- else -%}
                        {{ 'products.product.add_to_cart' | t }}
                    {%- endif -%}
                </span>

                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22.505 20">
                    <path d="M9.494-20.882a.9.9,0,0,1,.391,1.25L6.72-13.5h9.064L12.62-19.632a.9.9,0,0,1,.391-1.25.9.9,0,0,1,1.25.391L17.894-13.5h3.36a1.217,1.217,0,0,1,.9.352,1.217,1.217,0,0,1,.352.9,1.217,1.217,0,0,1-.352.9,1.217,1.217,0,0,1-.9.352L19.223-2.87a2.488,2.488,0,0,1-.9,1.328A2.329,2.329,0,0,1,16.8-.995H5.665a2.329,2.329,0,0,1-1.524-.547,2.576,2.576,0,0,1-.86-1.328L1.25-11a1.217,1.217,0,0,1-.9-.352,1.217,1.217,0,0,1-.352-.9,1.217,1.217,0,0,1,.352-.9,1.217,1.217,0,0,1,.9-.352H4.61l3.634-6.994A.9.9,0,0,1,9.494-20.882ZM5.626-9.434a.934.934,0,0,0,.938-.938.934.934,0,0,0-.938-.938.934.934,0,0,0-.938.938A.934.934,0,0,0,5.626-9.434ZM16.879-11.31a.934.934,0,0,0-.938.938.934.934,0,0,0,.938.938.934.934,0,0,0,.938-.938A.934.934,0,0,0,16.879-11.31Z"
                          transform="translate(0 20.995)" fill="currentColor"/>
                </svg>
            </button>
        {%- endif -%}
    {%- endform -%}
    <div class="product__error-message-wrapper">
        <div class="product__error-message"></div>
    </div>
</product-form>